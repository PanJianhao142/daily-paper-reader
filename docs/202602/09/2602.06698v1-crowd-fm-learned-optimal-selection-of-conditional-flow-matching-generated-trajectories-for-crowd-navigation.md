---
title: "Crowd-FM: Learned Optimal Selection of Conditional Flow Matching-generated Trajectories for Crowd Navigation"
title_zh: Crowd-FM：用于人群导航的条件流匹配生成轨迹的学习最优选择
authors: "Antareep Singha, Laksh Nanwani, Mathai Mathew P., Samkit Jain, Phani Teja Singamaneni, Arun Kumar Singh, K. Madhava Krishna"
date: 2026-02-06
pdf: "https://arxiv.org/pdf/2602.06698v1"
tags: ["keyword:FM"]
score: 6.0
evidence: 使用条件流匹配生成类人运动轨迹
tldr: 本文提出 Crowd-FM，一种针对密集人群导航的深度学习方法。该方法首先利用条件流匹配（CFM）在最优控制轨迹数据集上训练，以生成多模态的无碰撞运动原语；随后通过人类演示数据训练评分函数，用于在推理阶段筛选出最具“类人性”的最优轨迹。实验证明，该方法在安全性、导航成功率及轨迹自然度方面均优于现有的学习和优化基准。
motivation: 旨在解决移动机器人在密集人群中导航时，难以兼顾安全性、计算效率以及与人类行走行为相似性的挑战。
method: 结合了能够生成多模态无碰撞轨迹的条件流匹配策略，以及一个基于人类专家数据训练的轨迹评分网络。
result: 该方法在导航成功率上超过了现有学习模型，且在推理优化后性能优于复杂的优化算法，并能选出更接近人类行为的轨迹。
conclusion: Crowd-FM 证明了生成式流匹配模型与学习评分机制相结合，能有效提升机器人在复杂社交环境中的避障能力和接受度。
---

## 摘要
在密集、非结构化的人群中，为移动机器人实现安全且计算高效的局部规划仍然是一个基本挑战。此外，确保机器人轨迹与人类移动方式相似，将提高机器人在人类环境中的接受度。在本文中，我们提出了 Crowd-FM，这是一种基于学习的方法，旨在同时解决安全性与类人性的挑战。我们的方法包含两个新颖的组件。首先，我们在最优控制轨迹数据集上训练条件流匹配（CFM）策略，以学习一组机器人在任何给定场景下都可以选择的无碰撞原语。所选的最优控制求解器可以生成多模态无碰撞轨迹，使 CFM 策略能够学习多样化的机动动作。其次，我们在人类演示轨迹数据集上学习一个评分函数，为流原语提供类人性评分。在推理阶段，计算最优轨迹需要选择评分最高的那条。我们的方法改进了现有技术，证明了仅凭 CFM 策略就能实现比现有基于学习的基准方法成功率更高的无碰撞导航。此外，当结合推理时细化时，我们的方法甚至可以超越昂贵的基于优化的规划方法。最后，我们验证了我们的评分网络能够比手动设计的代价函数选择出更接近专家数据的轨迹。

## Abstract
Safe and computationally efficient local planning for mobile robots in dense, unstructured human crowds remains a fundamental challenge. Moreover, ensuring that robot trajectories are similar to how a human moves will increase the acceptance of the robot in human environments. In this paper, we present Crowd-FM, a learning-based approach to address both safety and human-likeness challenges. Our approach has two novel components. First, we train a Conditional Flow-Matching (CFM) policy over a dataset of optimally controlled trajectories to learn a set of collision-free primitives that a robot can choose at any given scenario. The chosen optimal control solver can generate multi-modal collision-free trajectories, allowing the CFM policy to learn a diverse set of maneuvers. Secondly, we learn a score function over a dataset of human demonstration trajectories that provides a human-likeness score for the flow primitives. At inference time, computing the optimal trajectory requires selecting the one with the highest score. Our approach improves the state-of-the-art by showing that our CFM policy alone can produce collision-free navigation with a higher success rate than existing learning-based baselines. Furthermore, when augmented with inference-time refinement, our approach can outperform even expensive optimisation-based planning approaches. Finally, we validate that our scoring network can select trajectories closer to the expert data than a manually designed cost function.