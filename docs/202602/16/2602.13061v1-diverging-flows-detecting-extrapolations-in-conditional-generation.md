---
title: "Diverging Flows: Detecting Extrapolations in Conditional Generation"
title_zh: 发散流：检测条件生成中的外推
authors: "Constantinos Tsakonas, Serena Ivaldi, Jean-Baptiste Mouret"
date: 2026-02-13
pdf: "https://arxiv.org/pdf/2602.13061v1"
tags: ["keyword:FM"]
score: 6.0
evidence: 用于预测任务和外推检测的流匹配技术
tldr: 流匹配（FM）模型在处理离流形（off-manifold）条件时，常因平滑偏差产生看似合理但错误的预测，导致安全隐患。本文提出 Diverging Flows，通过在结构上强制离流形输入的传输效率降低，使单一模型能同时进行条件生成和原生外推检测。实验证明该方法在不损失预测精度和推理速度的前提下，能有效识别外推错误，为医疗、机器人等关键领域的可靠部署提供了保障。
motivation: 现有的流匹配模型在面对训练分布外的条件时，容易产生难以察觉的错误预测，缺乏可靠的外推检测机制。
method: 引入 Diverging Flows 架构，通过结构化设计使离流形输入的传输路径发散或低效，从而实现原生的异常检测。
result: 在合成流形、风格迁移和天气预报等任务中，该方法成功检测出外推情况，且未影响生成质量和推理延迟。
conclusion: Diverging Flows 为构建可信的流模型提供了有效方案，显著提升了模型在安全敏感领域部署的可靠性。
---

## 摘要
流匹配（Flow Matching, FM）建模复杂条件分布的能力使其在预测任务（如机器人、天气预报）中达到了最先进水平。然而，在安全关键型环境中的部署受到严重外推风险的阻碍：在平滑性偏差的驱动下，流模型即使对于流形外（off-manifold）条件也会产生看似合理的输出，导致产生与有效预测难以区分的静默失败。在这项工作中，我们引入了发散流（Diverging Flows），这是一种新颖的方法，通过在结构上对流形外输入强制执行低效传输，使单个模型能够同时执行条件生成和原生外推检测。我们在合成流形、跨域风格迁移和天气温度预测上评估了我们的方法，证明了它在不损害预测保真度或推理延迟的情况下实现了有效的外推检测。这些结果确立了发散流作为可靠流模型的鲁棒解决方案，为在医学、机器人和气候科学等领域的可靠部署铺平了道路。

## Abstract
The ability of Flow Matching (FM) to model complex conditional distributions has established it as the state-of-the-art for prediction tasks (e.g., robotics, weather forecasting). However, deployment in safety-critical settings is hindered by a critical extrapolation hazard: driven by smoothness biases, flow models yield plausible outputs even for off-manifold conditions, resulting in silent failures indistinguishable from valid predictions. In this work, we introduce Diverging Flows, a novel approach that enables a single model to simultaneously perform conditional generation and native extrapolation detection by structurally enforcing inefficient transport for off-manifold inputs. We evaluate our method on synthetic manifolds, cross-domain style transfer, and weather temperature forecasting, demonstrating that it achieves effective detection of extrapolations without compromising predictive fidelity or inference latency. These results establish Diverging Flows as a robust solution for trustworthy flow models, paving the way for reliable deployment in domains such as medicine, robotics, and climate science.