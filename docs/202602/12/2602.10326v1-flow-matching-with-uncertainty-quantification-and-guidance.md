---
title: Flow Matching with Uncertainty Quantification and Guidance
title_zh: 具有不确定性量化与引导的流匹配
authors: "Juyeop Han, Lukas Lao Beyer, Sertac Karaman"
date: 2026-02-10
pdf: "https://arxiv.org/pdf/2602.10326v1"
tags: ["keyword:FM"]
score: 6.0
evidence: 带不确定性的流匹配生成
tldr: 针对流匹配生成模型采样质量不稳定的问题，本文提出了 UA-Flow 框架。该方法在预测速度场的同时估计异方差不确定性，并通过流动力学传播得到单个样本的可靠性信号。UA-Flow 不仅能有效评估样本保真度，还能利用不确定性信号引导采样过程（如分类器引导），在提升生成质量的同时增强了模型的可靠性。
motivation: 流匹配模型在生成过程中可能产生质量不一的样本，且缺乏有效的手段来评估样本可靠性并引导高质量输出。
method: 提出 UA-Flow 扩展，同步预测速度场与异方差不确定性，并将速度不确定性传播至整个流动力学路径以量化样本质量。
result: 实验证明 UA-Flow 的不确定性估计与样本保真度高度相关，且利用该信号进行引导采样能显著改善图像生成效果。
conclusion: UA-Flow 为流匹配模型引入了一种轻量级的不确定性量化与引导机制，有效提升了生成任务的性能与可信度。
---

## 摘要
尽管流匹配等基于采样的生成模型取得了显著成功，但它们仍可能产生质量不一致或退化的样本。为了评估样本可靠性并生成更高质量的输出，我们提出了不确定性感知流匹配（UA-Flow），这是流匹配的一种轻量级扩展，它在预测速度场的同时预测异方差不确定性。UA-Flow 通过在流动力学中传播速度不确定性来估计每个样本的不确定性。这些不确定性估计可作为单个样本的可靠性信号，我们进一步利用它们通过不确定性感知分类器引导和无分类器引导来引导生成过程。图像生成实验表明，与基线方法相比，UA-Flow 产生的不确定性信号与样本保真度的相关性更高，且不确定性引导采样进一步提升了生成质量。

## Abstract
Despite the remarkable success of sampling-based generative models such as flow matching, they can still produce samples of inconsistent or degraded quality. To assess sample reliability and generate higher-quality outputs, we propose uncertainty-aware flow matching (UA-Flow), a lightweight extension of flow matching that predicts the velocity field together with heteroscedastic uncertainty. UA-Flow estimates per-sample uncertainty by propagating velocity uncertainty through the flow dynamics. These uncertainty estimates act as a reliability signal for individual samples, and we further use them to steer generation via uncertainty-aware classifier guidance and classifier-free guidance. Experiments on image generation show that UA-Flow produces uncertainty signals more highly correlated with sample fidelity than baseline methods, and that uncertainty-guided sampling further improves generation quality.