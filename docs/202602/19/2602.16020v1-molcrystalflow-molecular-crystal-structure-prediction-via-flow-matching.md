---
title: "MolCrystalFlow: Molecular Crystal Structure Prediction via Flow Matching"
title_zh: MolCrystalFlow：基于流匹配的分子晶体结构预测
authors: "Cheng Zeng, Harry W. Sullivan, Thomas Egg, Maya M. Martirossyan, Philipp Höllmer, Jirui Jin, Richard G. Hennig, Adrian Roitberg, Stefano Martiniani, Ellad B. Tadmor, Mingjie Liu"
date: 2026-02-17
pdf: "https://arxiv.org/pdf/2602.16020v1"
tags: ["keyword:FM"]
score: 6.0
evidence: 用于结构预测的流匹配
tldr: 本研究针对分子晶体结构预测（CSP）中分子尺寸大、相互作用复杂的挑战，提出了MolCrystalFlow生成模型。该模型采用流匹配（Flow Matching）框架，将分子视为刚体以简化内部分子复杂度，并在黎曼流形上联合学习晶格、分子取向和质心位置。实验证明，该方法在多个数据集上优于现有生成模型和规则方法，并能与机器学习势能结合，显著加速了分子晶体的发现过程。
motivation: 分子晶体结构预测因分子规模大和复杂的相互作用而极具挑战，且现有生成模型难以有效处理全周期分子晶体。
method: 提出一种基于流匹配的生成框架，将分子嵌入为刚体，并在黎曼流形上利用图神经网络联合建模晶格、取向和质心。
result: 在两个开源分子晶体数据集上，该模型在性能上超越了最先进的生成模型和基于规则的结构生成方法。
conclusion: MolCrystalFlow通过整合通用机器学习势能，为数据驱动的分子晶体生成式发现开辟了新路径。
---

## 摘要
由于组成分子尺寸巨大且分子内与分子间相互作用复杂，分子晶体结构预测是计算化学领域的一项重大挑战。虽然生成模型已彻底改变了分子、无机固体和金属有机框架的结构发现，但将此类方法扩展到完全周期性的分子晶体仍然具有挑战性。在此，我们提出了 MolCrystalFlow，一种用于分子晶体结构预测的基于流（flow-based）的生成模型。该框架通过将分子嵌入为刚体，并联合学习晶格矩阵、分子取向和质心位置，将分子内部的复杂性与分子间的堆积解耦。质心和取向在它们原生的黎曼流形上表示，从而允许构建测地流（geodesic flow）和遵循几何对称性的图神经网络操作。我们在两个开源分子晶体数据集上，将我们的模型与针对大尺寸周期性晶体的最先进生成模型以及基于规则的结构生成方法进行了基准测试。我们展示了 MolCrystalFlow 模型与通用机器学习势能的集成，以加速分子晶体结构预测，为数据驱动的分子晶体生成式发现铺平了道路。

## Abstract
Molecular crystal structure prediction represents a grand challenge in computational chemistry due to large sizes of constituent molecules and complex intra- and intermolecular interactions. While generative modeling has revolutionized structure discovery for molecules, inorganic solids, and metal-organic frameworks, extending such approaches to fully periodic molecular crystals is still elusive. Here, we present MolCrystalFlow, a flow-based generative model for molecular crystal structure prediction. The framework disentangles intramolecular complexity from intermolecular packing by embedding molecules as rigid bodies and jointly learning the lattice matrix, molecular orientations, and centroid positions. Centroids and orientations are represented on their native Riemannian manifolds, allowing geodesic flow construction and graph neural network operations that respects geometric symmetries. We benchmark our model against state-of-the-art generative models for large-size periodic crystals and rule-based structure generation methods on two open-source molecular crystal datasets. We demonstrate an integration of MolCrystalFlow model with universal machine learning potential to accelerate molecular crystal structure prediction, paving the way for data-driven generative discovery of molecular crystals.