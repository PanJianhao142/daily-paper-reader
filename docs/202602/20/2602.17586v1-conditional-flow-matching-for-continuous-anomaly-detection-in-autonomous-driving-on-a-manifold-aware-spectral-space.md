---
title: Conditional Flow Matching for Continuous Anomaly Detection in Autonomous Driving on a Manifold-Aware Spectral Space
title_zh: 基于流形感知谱空间的自动驾驶连续异常检测条件流匹配
authors: Antonio Guillen-Perez
date: 2026-02-19
pdf: "https://arxiv.org/pdf/2602.17586v1"
tags: ["keyword:FM", "query:课题"]
score: 7.0
evidence: 用于人类驾驶行为的条件流匹配
tldr: 针对L4级自动驾驶中长尾高风险场景检测难的问题，本文提出Deep-Flow框架。该框架利用最优传输条件流匹配（OT-CFM）在低秩谱流形上建模专家驾驶行为的连续概率密度。通过PCA瓶颈确保运动学平滑性，并结合车道感知的Transformer编码器处理复杂路口的多模态歧义。实验表明，该方法在Waymo数据集上表现优异，能有效识别传统规则难以发现的分布外异常行为，为自动驾驶安全验证提供了数学基础。
motivation: 传统的基于规则的启发式方法难以扩展并准确识别自动驾驶中罕见且高风险的长尾异常场景。
method: 提出一种基于最优传输条件流匹配的无监督框架，在PCA降维后的谱空间内建模驾驶行为，并结合运动学复杂度加权进行训练。
result: 在Waymo开放运动数据集上达到了0.766的AUC-ROC，并成功识别出传统安全过滤器忽略的非规范路口操作等异常行为。
conclusion: 该研究通过流形感知的概率建模，为定义统计安全门限和实现数据驱动的自动驾驶车队安全验证奠定了理论基础。
---

## 摘要
L4 级自动驾驶汽车（AV）的安全验证目前正面临瓶颈，因为传统的基于规则的启发式方法无法大规模检测稀有的高风险长尾场景。我们提出了 Deep-Flow，这是一个用于安全关键异常检测的无监督框架，它利用最优传输条件流匹配（OT-CFM）来表征人类专家驾驶行为的连续概率密度。与在不稳定的高维坐标空间中运行的标准生成方法不同，Deep-Flow 通过主成分分析（PCA）瓶颈将生成过程约束在低秩谱流形上。这在设计上确保了运动学平滑性，并能够计算精确的雅可比矩阵迹，从而实现数值稳定、确定性的对数似然估计。为了解决复杂路口的多模态歧义，我们采用了具有车道感知目标调节的早期融合 Transformer 编码器，其特点是具有指向流头部的直接跳跃连接，以在整个网络中保持意图完整性。我们引入了一种运动学复杂度加权方案，在无仿真训练过程中优先考虑高能机动（通过路径曲折度和加加加速度量化）。在 Waymo 开放运动数据集（WOMD）上的评估表明，我们的框架在针对安全关键事件的启发式黄金标准集上实现了 0.766 的 AUC-ROC。更重要的是，我们的分析揭示了运动学危险与语义违规之间的根本区别。Deep-Flow 通过发现传统安全过滤器忽略的分布外行为（例如违反车道边界和非规范的路口机动），识别出了一个关键的可预测性差距。这项工作为定义统计安全门提供了数学严谨的基础，为自动驾驶车队的安全部署实现了客观、数据驱动的验证。

## Abstract
Safety validation for Level 4 autonomous vehicles (AVs) is currently bottlenecked by the inability to scale the detection of rare, high-risk long-tail scenarios using traditional rule-based heuristics. We present Deep-Flow, an unsupervised framework for safety-critical anomaly detection that utilizes Optimal Transport Conditional Flow Matching (OT-CFM) to characterize the continuous probability density of expert human driving behavior. Unlike standard generative approaches that operate in unstable, high-dimensional coordinate spaces, Deep-Flow constrains the generative process to a low-rank spectral manifold via a Principal Component Analysis (PCA) bottleneck. This ensures kinematic smoothness by design and enables the computation of the exact Jacobian trace for numerically stable, deterministic log-likelihood estimation. To resolve multi-modal ambiguity at complex junctions, we utilize an Early Fusion Transformer encoder with lane-aware goal conditioning, featuring a direct skip-connection to the flow head to maintain intent-integrity throughout the network. We introduce a kinematic complexity weighting scheme that prioritizes high-energy maneuvers (quantified via path tortuosity and jerk) during the simulation-free training process. Evaluated on the Waymo Open Motion Dataset (WOMD), our framework achieves an AUC-ROC of 0.766 against a heuristic golden set of safety-critical events. More significantly, our analysis reveals a fundamental distinction between kinematic danger and semantic non-compliance. Deep-Flow identifies a critical predictability gap by surfacing out-of-distribution behaviors, such as lane-boundary violations and non-normative junction maneuvers, that traditional safety filters overlook. This work provides a mathematically rigorous foundation for defining statistical safety gates, enabling objective, data-driven validation for the safe deployment of autonomous fleets.