---
title: "HiMAP: History-aware Map-occupancy Prediction with Fallback"
title_zh: HiMAP：具备回退机制的历史感知地图占用预测
authors: "Yiming Xu, Yi Yang, Hao Cheng, Monika Sester"
date: 2026-02-19
pdf: "https://arxiv.org/pdf/2602.17231v1"
tags: ["query:课题"]
score: 6.0
evidence: 用于运动预测的时空占用图
tldr: 针对自动驾驶中运动预测过度依赖多目标跟踪（MOT）身份关联的问题，本文提出HiMAP框架。该方法无需身份追踪，通过将历史检测转化为时空不变的占据地图，并利用历史查询模块从无标签占据表示中提取特定目标的特征。HiMAP在Argoverse 2上表现优异，在无追踪环境下显著超越现有基准，为安全关键的自动驾驶提供了可靠的备选方案。
motivation: 传统的运动预测方法高度依赖多目标跟踪的身份一致性，在发生遮挡或身份切换等跟踪失败时，预测质量会大幅下降并增加安全风险。
method: 提出一种无需追踪的预测框架，利用历史占据地图和查询模块迭代提取目标历史信息，并结合DETR式解码器生成多模态未来轨迹。
result: "在Argoverse 2数据集上，HiMAP在无追踪设置下的FDE和ADE分别提升了11%和12%，性能可媲美甚至超越基于追踪的强基准方法。"
conclusion: HiMAP证明了在不依赖身份关联的情况下也能实现高精度预测，为应对跟踪失效提供了稳健的备选方案，提升了自动驾驶系统的安全性。
---

## 摘要
准确的运动预测对于自动驾驶至关重要，然而大多数预测器依赖于具有身份关联的多目标跟踪（MOT），并假设目标被正确且连续地跟踪。当跟踪由于遮挡、身份切换或漏检等原因失败时，预测质量会下降，安全风险也会增加。我们提出了 HiMAP，这是一个无需跟踪的轨迹预测框架，在 MOT 失败的情况下仍能保持可靠。HiMAP 将过去的检测结果转换为时空不变的历史占用地图，并引入了一个历史查询模块，该模块以当前智能体状态为条件，从无标签的占用表示中迭代检索特定于智能体的历史信息。检索到的历史信息由时间地图嵌入进行总结，并与最终查询和地图上下文一起驱动 DETR 风格的解码器，以生成多模态未来轨迹。这种设计消除了对身份的依赖，通过可重用的编码支持流式推理，并在跟踪不可用时作为一种鲁棒的回退机制。在 Argoverse 2 数据集上，HiMAP 在不使用 ID 的情况下实现了与基于跟踪的方法相当的性能，并且在无跟踪设置下显著优于强基准模型，相比微调后的 QCNet，在 FDE 上获得了 11% 的相对增益，在 ADE 上获得了 12% 的增益，在 MR 上降低了 4%。除了综合指标外，HiMAP 还能同时为所有智能体提供稳定的预测，而无需等待跟踪恢复，突显了其在安全至关重要的自动驾驶中的实用价值。代码可在以下地址获取：https://github.com/XuYiMing83/HiMAP。

## Abstract
Accurate motion forecasting is critical for autonomous driving, yet most predictors rely on multi-object tracking (MOT) with identity association, assuming that objects are correctly and continuously tracked. When tracking fails due to, e.g., occlusion, identity switches, or missed detections, prediction quality degrades and safety risks increase. We present \textbf{HiMAP}, a tracking-free, trajectory prediction framework that remains reliable under MOT failures. HiMAP converts past detections into spatiotemporally invariant historical occupancy maps and introduces a historical query module that conditions on the current agent state to iteratively retrieve agent-specific history from unlabeled occupancy representations. The retrieved history is summarized by a temporal map embedding and, together with the final query and map context, drives a DETR-style decoder to produce multi-modal future trajectories. This design lifts identity reliance, supports streaming inference via reusable encodings, and serves as a robust fallback when tracking is unavailable. On Argoverse~2, HiMAP achieves performance comparable to tracking-based methods while operating without IDs, and it substantially outperforms strong baselines in the no-tracking setting, yielding relative gains of 11\% in FDE, 12\% in ADE, and a 4\% reduction in MR over a fine-tuned QCNet. Beyond aggregate metrics, HiMAP delivers stable forecasts for all agents simultaneously without waiting for tracking to recover, highlighting its practical value for safety-critical autonomy. The code is available under: https://github.com/XuYiMing83/HiMAP.