---
title: Is Flow Matching Just Trajectory Replay for Sequential Data?
title_zh: 流匹配（Flow Matching）仅仅是序列数据的轨迹重放吗？
authors: "Soon Hoe Lim, Shizheng Lin, Michael W. Mahoney, N. Benjamin Erichson"
date: 2026-02-09
pdf: "https://arxiv.org/pdf/2602.08318v1"
tags: ["keyword:FM", "query:课题"]
score: 7.0
evidence: 用于序列数据的流匹配
tldr: 本研究探讨了流匹配（FM）在序列数据生成中的本质，质疑其是学习了通用动力学还是仅在进行“轨迹重放”。通过推导经验FM目标的理想速度场，研究揭示了其采样器本质上是一个非参数、记忆增强的连续时间动力系统。该研究将神经FM模型视为理想非参数解的参数化替代，并提出了一种无需训练即可从历史转换中进行强力概率预测的闭式采样方案。
motivation: 探究流匹配在处理序列数据时，究竟是学习了底层的通用动力学结构，还是仅仅实现了对训练轨迹的有效重放。
method: 通过推导高斯条件路径下FM目标的理想速度场，将其表述为过去状态转换速度的相似度加权混合，并构建了非参数化的ODE采样器。
result: 实验表明，基于理想速度场结构的闭式采样器在非线性动力系统基准测试中，无需训练即可直接从历史数据中实现高质量的概率预测。
conclusion: 流匹配在序列数据上表现为一种记忆增强的动力系统，这一发现为提高生成效率和数值鲁棒性提供了理论基础和实用方案。
---

## 摘要
流匹配（FM）越来越多地被用于时间序列生成，但目前尚不清楚它究竟是学习了通用的动力学结构，还是仅仅执行了一种有效的“轨迹重放”。我们通过推导在完美函数逼近极限下，序列数据上经验 FM 目标所针对的速度场来研究这一问题。对于实践中常用的高斯条件路径，我们证明了其隐含的采样器是一个常微分方程（ODE），其动力学构成了一个非参数化的、记忆增强的连续时间动力系统。最优场具有闭式表达式，表现为由过去状态转移诱导的瞬时速度的相似度加权混合，从而使数据集依赖性变得明确且具有可解释性。这一视角将通过随机优化训练的神经 FM 模型定位为理想非参数解的参数化替代方案。利用最优场的结构，我们研究了能够提高基于 ODE 生成的效率和数值鲁棒性的采样与逼近方案。在非线性动力系统基准测试中，由此产生的闭式采样器无需训练即可直接从历史转移中产生强大的概率预测。

## Abstract
Flow matching (FM) is increasingly used for time-series generation, but it is not well understood whether it learns a general dynamical structure or simply performs an effective "trajectory replay". We study this question by deriving the velocity field targeted by the empirical FM objective on sequential data, in the limit of perfect function approximation. For the Gaussian conditional paths commonly used in practice, we show that the implied sampler is an ODE whose dynamics constitutes a nonparametric, memory-augmented continuous-time dynamical system. The optimal field admits a closed-form expression as a similarity-weighted mixture of instantaneous velocities induced by past transitions, making the dataset dependence explicit and interpretable. This perspective positions neural FM models trained by stochastic optimization as parametric surrogates of an ideal nonparametric solution. Using the structure of the optimal field, we study sampling and approximation schemes that improve the efficiency and numerical robustness of ODE-based generation. On nonlinear dynamical system benchmarks, the resulting closed-form sampler yields strong probabilistic forecasts directly from historical transitions, without training.