---
title: Trajectory Stitching for Solving Inverse Problems with Flow-Based Models
title_zh: 基于流模型求解反问题的轨迹拼接方法
authors: "Alexander Denker, Moshe Eliasof, Zeljko Kereta, Carola-Bibiane Schönlieb"
date: 2026-02-09
pdf: "https://arxiv.org/pdf/2602.08538v1"
tags: ["keyword:FM"]
score: 6.0
evidence: 基于流的生成模型和轨迹匹配
tldr: 本研究针对基于流（Flow-based）的生成模型在解决逆问题时，直接优化初始潜码导致的高内存消耗和数值不稳定问题，提出了 MS-Flow 方法。该方法将生成轨迹表示为一系列中间潜状态的序列，通过局部执行流动力学并利用轨迹匹配惩罚项进行耦合，实现了在降低内存占用的同时提升重建质量。实验证明，MS-Flow 在图像修复、超分辨率和 CT 成像等任务中表现优于现有方法。
motivation: 传统的流模型逆问题求解需对整个生成轨迹进行反向传播，导致内存开销巨大且存在数值不稳定性。
method: 提出 MS-Flow 框架，将轨迹分解为多个中间状态，通过交替更新这些状态并引入轨迹匹配惩罚项来确保一致性。
result: 在图像修复、超分辨率和计算机断层扫描等任务中，该方法显著降低了内存需求并提升了图像重建的精度。
conclusion: MS-Flow 为基于流模型的逆问题求解提供了一种更高效、更稳定的轨迹优化方案。
---

## 摘要
基于流的生成模型已成为求解反问题的强大先验。一种选择是直接优化初始潜码（噪声），使流输出能够解决反问题。然而，这需要通过整个生成轨迹进行反向传播，从而导致高昂的内存开销和数值不稳定性。我们提出了 MS-Flow，它将轨迹表示为一系列中间潜状态，而非单个初始编码。通过在局部强制执行流动力学，并通过轨迹匹配惩罚项耦合各分段，MS-Flow 在更新中间潜状态和强制与观测数据保持一致性之间交替进行。这在降低内存消耗的同时提高了重建质量。我们在图像恢复和反问题（包括图像修复、超分辨率和计算机断层扫描）上证明了 MS-Flow 优于现有方法的有效性。

## Abstract
Flow-based generative models have emerged as powerful priors for solving inverse problems. One option is to directly optimize the initial latent code (noise), such that the flow output solves the inverse problem. However, this requires backpropagating through the entire generative trajectory, incurring high memory costs and numerical instability. We propose MS-Flow, which represents the trajectory as a sequence of intermediate latent states rather than a single initial code. By enforcing the flow dynamics locally and coupling segments through trajectory-matching penalties, MS-Flow alternates between updating intermediate latent states and enforcing consistency with observed data. This reduces memory consumption while improving reconstruction quality. We demonstrate the effectiveness of MS-Flow over existing methods on image recovery and inverse problems, including inpainting, super-resolution, and computed tomography.