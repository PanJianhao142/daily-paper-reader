---
title: A Kinetic-Energy Perspective of Flow Matching
title_zh: 流匹配的动能视角
authors: "Ziyun Li, Huancheng Hu, Soon Hoe Lim, Xuyu Li, Fei Gao, Enmao Diao, Zezhen Ding, Michalis Vazirgiannis, Henrik Bostrom"
date: 2026-02-08
pdf: "https://arxiv.org/pdf/2602.07928v1"
tags: ["keyword:FM", "query:课题"]
score: 7.0
evidence: 流匹配和轨迹能量的理论分析
tldr: 本研究从物理学视角审视流匹配模型，提出动能路径能量（KPE）作为衡量采样轨迹动力学代价的指标。研究发现KPE与生成质量及数据密度存在非单调关联：适度高能量可提升语义保真度，但过高能量会导致模型产生记忆效应。基于此，作者提出无需训练的动力学轨迹整形（KTS）推理策略，通过优化轨迹动能分布，在减少记忆的同时显著提升了生成质量。
motivation: 旨在通过物理学中的动能视角，量化并理解流匹配生成模型中采样轨迹的动力学特性及其与生成质量、数据密度之间的内在联系。
method: 引入动能路径能量（KPE）诊断指标，并提出一种名为动力学轨迹整形（KTS）的推理策略，通过在采样初期增强运动并在后期实现软着陆来优化轨迹。
result: 实验证明KPE能有效预测语义保真度，而KTS策略在不增加训练成本的情况下，成功减少了模型对训练数据的记忆并提升了生成任务的性能。
conclusion: 揭示了采样轨迹能量与生成质量间的“金发姑娘原则”，证明了通过动力学干预可有效平衡生成模型的保真度与创新性。
---

## 摘要
基于流的生成模型可以通过物理视角来观察：采样过程通过积分随时间变化的速度场，将粒子从噪声传输到数据，每个样本对应一条具有自身动力学代价的轨迹。受经典力学启发，我们引入了动能路径能量（Kinetic Path Energy, KPE），这是一种类似于作用量的单样本诊断指标，用于衡量沿常微分方程（ODE）轨迹累积的动能代价。实验表明，KPE 表现出两种稳健的对应关系：(i) 较高的 KPE 预示着更强的语义保真度；(ii) 高 KPE 轨迹终止于低密度流形边界。我们进一步提供了将轨迹能量与数据密度联系起来的理论保证。矛盾的是，这种相关性是非单调的。在能量足够高时，生成过程可能会退化为记忆。利用经验流匹配的闭式解，我们证明了极端能量会驱动轨迹趋向于训练样本的近乎副本。这产生了一个“金发姑娘原则”，并启发了动能轨迹塑造（Kinetic Trajectory Shaping, KTS）。这是一种无需训练的两阶段推理策略，通过增强早期运动并强制执行后期软着陆，在基准任务中减少了记忆效应并提高了生成质量。

## Abstract
Flow-based generative models can be viewed through a physics lens: sampling transports a particle from noise to data by integrating a time-varying velocity field, and each sample corresponds to a trajectory with its own dynamical effort. Motivated by classical mechanics, we introduce Kinetic Path Energy (KPE), an action-like, per-sample diagnostic that measures the accumulated kinetic effort along an Ordinary Differential Equation (ODE) trajectory. Empirically, KPE exhibits two robust correspondences: (i) higher KPE predicts stronger semantic fidelity; (ii) high-KPE trajectories terminate on low-density manifold frontiers. We further provide theoretical guarantees linking trajectory energy to data density. Paradoxically, this correlation is non-monotonic. At sufficiently high energy, generation can degenerate into memorization. Leveraging the closed-form of empirical flow matching, we show that extreme energies drive trajectories toward near-copies of training examples. This yields a Goldilocks principle and motivates Kinetic Trajectory Shaping (KTS), a training-free two-phase inference strategy that boosts early motion and enforces a late-time soft landing, reducing memorization and improving generation quality across benchmark tasks.